#!/bin/bash

# Function to display available Wi-Fi networks
show_wifi_networks() {
    nmcli device wifi list
}

# Function to connect to a Wi-Fi network
connect_to_wifi() {
    nmcli --mode tabular device wifi list | awk 'NR>1 {gsub(/\*/, " (In Use)", $1); print NR-1 ". " $3 " - " $2}'
    read -p "Enter the number of the Wi-Fi network to connect to: " choice

    # Find the corresponding Wi-Fi network SSID
    ssid=$(nmcli --mode tabular device wifi list | awk 'NR>1 {if (NR-1 == '$choice') print $3}')

    if [ -n "$ssid" ]; then
        read -s -p "Enter the password for $ssid: " password
        echo

        # Attempt to connect to the Wi-Fi network
        nmcli device wifi connect "$ssid" password "$password"
    else
        echo "Invalid selection. No connection was made."
    fi
}

# Function to disconnect from a specific Wi-Fi connection
disconnect_from_wifi() {
    nmcli -t -f NAME,UUID,TYPE,DEVICE con show --active | grep wifi | while IFS=: read -r name uuid type device; do
        echo "$name"
    done
    read -p "Enter the name of the Wi-Fi network to disconnect from: " network_name

    # Disconnect from the specified Wi-Fi network
    nmcli c down "$network_name"
}

# Main menu
echo "1. Show available Wi-Fi networks"
echo "2. Connect to a Wi-Fi network"
echo "3. Disconnect from a Wi-Fi network"
read -p "Enter your choice (1, 2, or 3): " choice

case $choice in
    1)
        show_wifi_networks
        ;;
    2)
        connect_to_wifi
        ;;
    3)
        disconnect_from_wifi
        ;;
    *)
        echo "Invalid choice. Exiting."
        ;;
esac
